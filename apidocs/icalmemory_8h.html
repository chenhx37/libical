<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Libical API Documentation: icalmemory.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Libical API Documentation
   &#160;<span id="projectnumber">3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b7a0ea939f6e83384f3c571d31a84be9.html">libical</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">icalmemory.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Common memory management routines.  
<a href="#details">More...</a></p>

<p><a href="icalmemory_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae9f1799733a1577748a028181098be48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="icalmemory_8h.html#ae9f1799733a1577748a028181098be48">icalmemory_add_tmp_buffer</a> (void *buf)</td></tr>
<tr class="memdesc:ae9f1799733a1577748a028181098be48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds an externally allocated buffer to the ring.  <a href="icalmemory_8h.html#ae9f1799733a1577748a028181098be48">More...</a><br /></td></tr>
<tr class="separator:ae9f1799733a1577748a028181098be48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addac122edb16bc41a193895c86bd5ff5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="icalmemory_8h.html#addac122edb16bc41a193895c86bd5ff5">icalmemory_append_char</a> (char **buf, char **pos, size_t *buf_size, char ch)</td></tr>
<tr class="memdesc:addac122edb16bc41a193895c86bd5ff5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends a character to a buffer.  <a href="icalmemory_8h.html#addac122edb16bc41a193895c86bd5ff5">More...</a><br /></td></tr>
<tr class="separator:addac122edb16bc41a193895c86bd5ff5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a647bf5dab81fc5b83a0ed8f8ad769ea6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="icalmemory_8h.html#a647bf5dab81fc5b83a0ed8f8ad769ea6">icalmemory_append_string</a> (char **buf, char **pos, size_t *buf_size, const char *string)</td></tr>
<tr class="memdesc:a647bf5dab81fc5b83a0ed8f8ad769ea6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends a string to a buffer.  <a href="icalmemory_8h.html#a647bf5dab81fc5b83a0ed8f8ad769ea6">More...</a><br /></td></tr>
<tr class="separator:a647bf5dab81fc5b83a0ed8f8ad769ea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f164cb87c67f06b5dc04a5f21384879"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="icalmemory_8h.html#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a> (void *buf)</td></tr>
<tr class="memdesc:a2f164cb87c67f06b5dc04a5f21384879"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases a buffer.  <a href="icalmemory_8h.html#a2f164cb87c67f06b5dc04a5f21384879">More...</a><br /></td></tr>
<tr class="separator:a2f164cb87c67f06b5dc04a5f21384879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a175daa67f089bae6aefd4360fcd0d664"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="icalmemory_8h.html#a175daa67f089bae6aefd4360fcd0d664">icalmemory_free_ring</a> (void)</td></tr>
<tr class="memdesc:a175daa67f089bae6aefd4360fcd0d664"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees all memory used in the ring.  <a href="icalmemory_8h.html#a175daa67f089bae6aefd4360fcd0d664">More...</a><br /></td></tr>
<tr class="separator:a175daa67f089bae6aefd4360fcd0d664"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44986d86c778125a313d423b70cd2b54"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54">icalmemory_new_buffer</a> (size_t size)</td></tr>
<tr class="memdesc:a44986d86c778125a313d423b70cd2b54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates new buffer with the specified size.  <a href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54">More...</a><br /></td></tr>
<tr class="separator:a44986d86c778125a313d423b70cd2b54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e657ee861bf1f00ed4e6eb03cd4a0a5"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="icalmemory_8h.html#a4e657ee861bf1f00ed4e6eb03cd4a0a5">icalmemory_resize_buffer</a> (void *buf, size_t size)</td></tr>
<tr class="memdesc:a4e657ee861bf1f00ed4e6eb03cd4a0a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resizes a buffer created with <a class="el" href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54" title="Creates new buffer with the specified size.">icalmemory_new_buffer()</a>.  <a href="icalmemory_8h.html#a4e657ee861bf1f00ed4e6eb03cd4a0a5">More...</a><br /></td></tr>
<tr class="separator:a4e657ee861bf1f00ed4e6eb03cd4a0a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeae6b906a9fcba61eb725d060361b180"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="icalmemory_8h.html#aeae6b906a9fcba61eb725d060361b180">icalmemory_strdup</a> (const char *s)</td></tr>
<tr class="memdesc:aeae6b906a9fcba61eb725d060361b180"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a duplicate of a string.  <a href="icalmemory_8h.html#aeae6b906a9fcba61eb725d060361b180">More...</a><br /></td></tr>
<tr class="separator:aeae6b906a9fcba61eb725d060361b180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad73fe2ed5791e8d4d4513b1e23f7b86e"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="icalmemory_8h.html#ad73fe2ed5791e8d4d4513b1e23f7b86e">icalmemory_tmp_buffer</a> (size_t size)</td></tr>
<tr class="memdesc:ad73fe2ed5791e8d4d4513b1e23f7b86e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new temporary buffer on the ring and returns it.  <a href="icalmemory_8h.html#ad73fe2ed5791e8d4d4513b1e23f7b86e">More...</a><br /></td></tr>
<tr class="separator:ad73fe2ed5791e8d4d4513b1e23f7b86e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f5eccaa6b37d176a970b7d3a9f7aa66"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="icalmemory_8h.html#a3f5eccaa6b37d176a970b7d3a9f7aa66">icalmemory_tmp_copy</a> (const char *str)</td></tr>
<tr class="memdesc:a3f5eccaa6b37d176a970b7d3a9f7aa66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a copy of the given string, stored on the ring buffer, and returns it.  <a href="icalmemory_8h.html#a3f5eccaa6b37d176a970b7d3a9f7aa66">More...</a><br /></td></tr>
<tr class="separator:a3f5eccaa6b37d176a970b7d3a9f7aa66"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Common memory management routines. </p>
<p>libical often passes strings back to the caller. To make these interfaces simple, I did not want the caller to have to pass in a memory buffer, but having libical pass out newly allocated memory makes it difficult to de-allocate the memory.</p>
<p>The ring buffer in this scheme makes it possible for libical to pass out references to memory which the caller does not own, and be able to de-allocate the memory later. The ring allows libical to have several buffers active simultaneously, which is handy when creating string representations of components. Methods for working with these temporary buffers are marked with <code>icalmemory_tmp_*()</code>.</p>
<p>Other memory management routines include wrappers around the system management routines like <a class="el" href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54" title="Creates new buffer with the specified size.">icalmemory_new_buffer()</a> and <a class="el" href="icalmemory_8h.html#a2f164cb87c67f06b5dc04a5f21384879" title="Releases a buffer.">icalmemory_free_buffer()</a> as well as routines to work with strings, like <a class="el" href="icalmemory_8h.html#a647bf5dab81fc5b83a0ed8f8ad769ea6" title="Appends a string to a buffer.">icalmemory_append_string()</a>. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae9f1799733a1577748a028181098be48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9f1799733a1577748a028181098be48">&#9670;&nbsp;</a></span>icalmemory_add_tmp_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_add_tmp_buffer </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds an externally allocated buffer to the ring. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>The externally allocated buffer to add to the ring</td></tr>
  </table>
  </dd>
</dl>
<p>Adds an externally allocated buffer to the ring. This ensures that libical will <code>free()</code> the buffer automatically, either after ::BUFFER_RING_SIZE other buffers have been created or added, or after <a class="el" href="icalmemory_8h.html#a175daa67f089bae6aefd4360fcd0d664" title="Frees all memory used in the ring.">icalmemory_free_ring()</a> has been called.</p>
<dl class="section user"><dt>Error handling</dt><dd>No error is raised if <em>buf</em> is <code>NULL</code>.</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>After adding <em>buf</em> to the ring, it becomes owned by icalmemory and must not be <code>free()</code>d manually anymore, it leads to a double-<code>free()</code> when icalmemory reclaims the memory.</dd></dl>
<h3><a class="anchor" id="autotoc_md42"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="keywordtype">char</span> *buf = calloc(256, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"> </div>
<div class="line"><a class="code" href="icalmemory_8h.html#ae9f1799733a1577748a028181098be48">icalmemory_add_tmp_buffer</a>(buf);</div>
</div><!-- fragment --> 
</div>
</div>
<a id="addac122edb16bc41a193895c86bd5ff5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addac122edb16bc41a193895c86bd5ff5">&#9670;&nbsp;</a></span>icalmemory_append_char()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_append_char </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>buf_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>ch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Appends a character to a buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>The buffer to append the character to. </td></tr>
    <tr><td class="paramname">pos</td><td>The position to append the character at. </td></tr>
    <tr><td class="paramname">buf_size</td><td>The size of the buffer (will be changed if buffer is reallocated) </td></tr>
    <tr><td class="paramname">ch</td><td>The character to append to the buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>This method may not be used for temporary buffers (buffers allocated with <a class="el" href="icalmemory_8h.html#ad73fe2ed5791e8d4d4513b1e23f7b86e" title="Creates a new temporary buffer on the ring and returns it.">icalmemory_tmp_buffer()</a> and related functions)!</dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>Sets <a class="el" href="icalerror_8h.html#ad2562706150f5c5a4d9b0ca149d78e37" title="Access the current icalerrno value.">icalerrno</a> to <a class="el" href="icalerror_8h.html#a601c122fcea522513b1b7732fa23e833a2cc8bbcd8c07fc9a16e36f7aae5757b1">ICAL_BADARG_ERROR</a> if <em>buf</em>, <code>*buf</code>, <em>pos</em>, <code>* pos</code>, or <em>buf_size</em> <code>NULL</code>.</dd></dl>
<p>This method will copy the character <em>ch</em> and a &lsquo;&rsquo;\0'` character after it to the buffer <em>buf</em> starting at position <em>pos</em>, reallocing <em>buf</em> if it is too small. <em>buf_size</em> is the size of <em>buf</em> and will be changed if <em>buf</em> is reallocated. <em>pos</em> will point to the new terminating &lsquo;&rsquo;\0'` character <em>buf</em>.</p>
<h3><a class="anchor" id="autotoc_md47"></a>
Example</h3>
<div class="fragment"><div class="line"><span class="comment">// creates a new buffer</span></div>
<div class="line"><span class="keywordtype">int</span> buffer_len = 15;</div>
<div class="line"><span class="keywordtype">char</span> *buffer = <a class="code" href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54">icalmemory_new_buffer</a>(buffer_len);</div>
<div class="line">strcpy(buffer, <span class="stringliteral">&quot;My number is: &quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// append a char to the buffer</span></div>
<div class="line"><span class="keywordtype">int</span> buffer_end = strlen(buffer);</div>
<div class="line"><span class="keywordtype">char</span> *buffer_end_pos = buffer[buffer_str_end];</div>
<div class="line"><a class="code" href="icalmemory_8h.html#addac122edb16bc41a193895c86bd5ff5">icalmemory_append_char</a>(&amp;buffer, &amp;buffer_end_pos, &amp;buffer_len, <span class="charliteral">&#39;7&#39;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// print string</span></div>
<div class="line">printf(<span class="stringliteral">&quot;%s\n&quot;</span>, buffer);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release memory</span></div>
<div class="line"><a class="code" href="icalmemory_8h.html#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a>(buffer);</div>
</div><!-- fragment --> 
</div>
</div>
<a id="a647bf5dab81fc5b83a0ed8f8ad769ea6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a647bf5dab81fc5b83a0ed8f8ad769ea6">&#9670;&nbsp;</a></span>icalmemory_append_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_append_string </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>buf_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>string</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Appends a string to a buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>The buffer to append the string to. </td></tr>
    <tr><td class="paramname">pos</td><td>The position to append the string at. </td></tr>
    <tr><td class="paramname">buf_size</td><td>The size of the buffer (will be changed if buffer is reallocated) </td></tr>
    <tr><td class="paramname">string</td><td>The string to append to the buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>This method may not be used for temporary buffers (buffers allocated with <a class="el" href="icalmemory_8h.html#ad73fe2ed5791e8d4d4513b1e23f7b86e" title="Creates a new temporary buffer on the ring and returns it.">icalmemory_tmp_buffer()</a> and related functions)!</dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>Sets <a class="el" href="icalerror_8h.html#ad2562706150f5c5a4d9b0ca149d78e37" title="Access the current icalerrno value.">icalerrno</a> to <a class="el" href="icalerror_8h.html#a601c122fcea522513b1b7732fa23e833a2cc8bbcd8c07fc9a16e36f7aae5757b1">ICAL_BADARG_ERROR</a> if <em>buf</em>, <code>*buf</code>, <em>pos</em>, <code>* pos</code>, <em>buf_size</em> or <em>string</em> are <code>NULL</code>.</dd></dl>
<p>This method will copy the string <em>string</em> to the buffer <em>buf</em> starting at position <em>pos</em>, reallocing <em>buf</em> if it is too small. <em>buf_size</em> is the size of <em>buf</em> and will be changed if <em>buf</em> is reallocated. <em>pos</em> will point to the last byte of the new string in <em>buf</em>, usually a &lsquo;&rsquo;\0'`</p>
<h3><a class="anchor" id="autotoc_md46"></a>
Example</h3>
<div class="fragment"><div class="line"><span class="comment">// creates a new buffer</span></div>
<div class="line"><span class="keywordtype">int</span> buffer_len = 15;</div>
<div class="line"><span class="keywordtype">char</span> *buffer = <a class="code" href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54">icalmemory_new_buffer</a>(buffer_len);</div>
<div class="line">strcpy(buffer, <span class="stringliteral">&quot;My name is: &quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// append a string to the buffer</span></div>
<div class="line"><span class="keywordtype">int</span> buffer_end = strlen(buffer);</div>
<div class="line"><span class="keywordtype">char</span> *buffer_end_pos = buffer[buffer_str_end];</div>
<div class="line"><a class="code" href="icalmemory_8h.html#a647bf5dab81fc5b83a0ed8f8ad769ea6">icalmemory_append_string</a>(&amp;buffer, &amp;buffer_end_pos, &amp;buffer_len, <span class="stringliteral">&quot;John Doe&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// print string</span></div>
<div class="line">printf(<span class="stringliteral">&quot;%s\n&quot;</span>, buffer);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release memory</span></div>
<div class="line"><a class="code" href="icalmemory_8h.html#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a>(buffer);</div>
</div><!-- fragment --> 
</div>
</div>
<a id="a2f164cb87c67f06b5dc04a5f21384879"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f164cb87c67f06b5dc04a5f21384879">&#9670;&nbsp;</a></span>icalmemory_free_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_free_buffer </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases a buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>The buffer to release </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54" title="Creates new buffer with the specified size.">icalmemory_new_buffer()</a></dd></dl>
<p>Releases the memory of the buffer. </p>

</div>
</div>
<a id="a175daa67f089bae6aefd4360fcd0d664"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a175daa67f089bae6aefd4360fcd0d664">&#9670;&nbsp;</a></span>icalmemory_free_ring()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_free_ring </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees all memory used in the ring. </p>
<p>Frees all memory used in the ring. Depending on if ::HAVE_PTHREAD is set or not, the ring buffer is allocated on a per-thread basis, meaning that if all rings are to be released, it must be called once in every thread.</p>
<h3><a class="anchor" id="autotoc_md43"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> *buf = <a class="code" href="icalmemory_8h.html#ad73fe2ed5791e8d4d4513b1e23f7b86e">icalmemory_tmp_buffer</a>(256);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// use buf</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// release buf and all other memory in the ring buffer</span></div>
<div class="line"><a class="code" href="icalmemory_8h.html#a175daa67f089bae6aefd4360fcd0d664">icalmemory_free_ring</a>();</div>
</div><!-- fragment --> 
</div>
</div>
<a id="a44986d86c778125a313d423b70cd2b54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44986d86c778125a313d423b70cd2b54">&#9670;&nbsp;</a></span>icalmemory_new_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* icalmemory_new_buffer </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates new buffer with the specified size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>The size of the buffer that is to be created. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the newly-created buffer. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="icalmemory_8h.html#a2f164cb87c67f06b5dc04a5f21384879" title="Releases a buffer.">icalmemory_free_buffer()</a></dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>If there is a problem allocating memory, it sets <a class="el" href="icalerror_8h.html#ad2562706150f5c5a4d9b0ca149d78e37" title="Access the current icalerrno value.">icalerrno</a> to <a class="el" href="icalerror_8h.html#a601c122fcea522513b1b7732fa23e833a055394ffaf6701aa12491dc10767f07d">ICAL_NEWFAILED_ERROR</a> and returns <code>NULL</code>.</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>Buffers created with this method are owned by the caller. The must be released with the appropriate <a class="el" href="icalmemory_8h.html#a2f164cb87c67f06b5dc04a5f21384879" title="Releases a buffer.">icalmemory_free_buffer()</a> method.</dd></dl>
<p>This creates a new (non-temporary) buffer of the specified <em>size</em>. All buffers returned by this method are zeroed-out.</p>
<h3><a class="anchor" id="autotoc_md44"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="comment">// create buffer</span></div>
<div class="line"><span class="keywordtype">char</span> *buffer = <a class="code" href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54">icalmemory_new_buffer</a>(50);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// fill buffer</span></div>
<div class="line">strcpy(buffer, <span class="stringliteral">&quot;some data&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release buffer</span></div>
<div class="line"><a class="code" href="icalmemory_8h.html#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a>(buffer);</div>
</div><!-- fragment --> 
</div>
</div>
<a id="a4e657ee861bf1f00ed4e6eb03cd4a0a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e657ee861bf1f00ed4e6eb03cd4a0a5">&#9670;&nbsp;</a></span>icalmemory_resize_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* icalmemory_resize_buffer </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resizes a buffer created with <a class="el" href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54" title="Creates new buffer with the specified size.">icalmemory_new_buffer()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>The buffer to be resized. </td></tr>
    <tr><td class="paramname">size</td><td>The new size of the buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The new, resized buffer. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54" title="Creates new buffer with the specified size.">icalmemory_new_buffer()</a> </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This method may not be used for temporary buffers (buffers allocated with <a class="el" href="icalmemory_8h.html#ad73fe2ed5791e8d4d4513b1e23f7b86e" title="Creates a new temporary buffer on the ring and returns it.">icalmemory_tmp_buffer()</a> and related functions)!</dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>If there is a problem while reallocating the buffer, the method sets <a class="el" href="icalerror_8h.html#ad2562706150f5c5a4d9b0ca149d78e37" title="Access the current icalerrno value.">icalerrno</a> to <a class="el" href="icalerror_8h.html#a601c122fcea522513b1b7732fa23e833a055394ffaf6701aa12491dc10767f07d">ICAL_NEWFAILED_ERROR</a> and returns <code>NULL</code>.</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>The returned buffer is owned by the caller and needs to be released with the appropriate <a class="el" href="icalmemory_8h.html#a2f164cb87c67f06b5dc04a5f21384879" title="Releases a buffer.">icalmemory_free_buffer()</a> method. The old buffer, <em>buf</em>, can not be used anymore after calling this method.</dd></dl>
<h3><a class="anchor" id="autotoc_md45"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="comment">// create new buffer</span></div>
<div class="line"><span class="keywordtype">char</span> *buffer = <a class="code" href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54">icalmemory_new_buffer</a>(10);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// fill buffer</span></div>
<div class="line">strcpy(buffer, <span class="stringliteral">&quot;some data&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// expand buffer</span></div>
<div class="line">buffer = <a class="code" href="icalmemory_8h.html#a4e657ee861bf1f00ed4e6eb03cd4a0a5">icalmemory_resize_buffer</a>(buffer, 20);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// fill with more data</span></div>
<div class="line">strcpy(buffer, <span class="stringliteral">&quot;a lot more data&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release</span></div>
<div class="line"><a class="code" href="icalmemory_8h.html#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a>(buffer);</div>
</div><!-- fragment --> 
</div>
</div>
<a id="aeae6b906a9fcba61eb725d060361b180"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeae6b906a9fcba61eb725d060361b180">&#9670;&nbsp;</a></span>icalmemory_strdup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* icalmemory_strdup </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a duplicate of a string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The string to duplicate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to a string containing the same data as <em>s</em> </dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>The string <em>s</em> must not be <code>NULL</code>, otherwise depending on the <code>libc</code> used, it might lead to undefined behaviour (read: segfaults).</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>The returned string is owned by the caller and needs to be released with the appropriate <code>free()</code> method.</dd></dl>
<p>A wrapper around <code>strdup()</code>. Partly to trap calls to <code>strdup()</code>, partly because in <code>-ansi</code>, <code>gcc</code> on Red Hat claims that <code>strdup()</code> is undeclared.</p>
<h3><a class="anchor" id="autotoc_md48"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *my_str = <span class="stringliteral">&quot;LibIcal&quot;</span>;</div>
<div class="line"><span class="keywordtype">char</span> *dup = <a class="code" href="icalmemory_8h.html#aeae6b906a9fcba61eb725d060361b180">icalmemory_strdup</a>(my_str);</div>
<div class="line">printf(<span class="stringliteral">&quot;%s\n&quot;</span>, dup);</div>
<div class="line">free(dup);</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ad73fe2ed5791e8d4d4513b1e23f7b86e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad73fe2ed5791e8d4d4513b1e23f7b86e">&#9670;&nbsp;</a></span>icalmemory_tmp_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* icalmemory_tmp_buffer </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new temporary buffer on the ring and returns it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>How big (in bytes) the buffer should be </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the newly created buffer on the ring</dd></dl>
<p>Creates a temporary buffer on the ring. Regardless of what <em>size</em> you specify, the buffer will always be at least ::MIN_BUFFER_SIZE big, and it will be zeroed out.</p>
<dl class="section user"><dt>Error handling</dt><dd>If there is a problem allocating memory for the buffer, it sets <a class="el" href="icalerror_8h.html#ad2562706150f5c5a4d9b0ca149d78e37" title="Access the current icalerrno value.">icalerrno</a> to <a class="el" href="icalerror_8h.html#a601c122fcea522513b1b7732fa23e833a055394ffaf6701aa12491dc10767f07d">ICAL_NEWFAILED_ERROR</a> and returns <code>NULL</code>.</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>The returned buffer is owned by icalmemory. It must not be freed by the caller and the returned memory will be automatically reclaimed as more items are added to the ring buffer.</dd></dl>
<h3><a class="anchor" id="autotoc_md40"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="keywordtype">char</span> *str = <a class="code" href="icalmemory_8h.html#ad73fe2ed5791e8d4d4513b1e23f7b86e">icalmemory_tmp_buffer</a>(256);</div>
<div class="line">strcpy(str, <span class="stringliteral">&quot;some data&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// use str</span></div>
</div><!-- fragment --> 
</div>
</div>
<a id="a3f5eccaa6b37d176a970b7d3a9f7aa66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f5eccaa6b37d176a970b7d3a9f7aa66">&#9670;&nbsp;</a></span>icalmemory_tmp_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* icalmemory_tmp_copy </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a copy of the given string, stored on the ring buffer, and returns it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">str</td><td>The string to copy </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A copy of <em>str</em>, which has been placed on the ring buffer for automatic reclamation.</dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>The passed string <em>str</em> must not be <code>NULL</code>, otherwise a segfault might ensue, since the routine calls <code>strlen()</code> on it.</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>The returned string is owned by icalmemory. It must not be freed by the caller, and it will be automatically reclaimed as more items are added to the buffer.</dd></dl>
<h3><a class="anchor" id="autotoc_md41"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *str = <span class="stringliteral">&quot;Example string&quot;</span>;</div>
<div class="line"><span class="keywordtype">char</span> *tmp_copy = <a class="code" href="icalmemory_8h.html#a3f5eccaa6b37d176a970b7d3a9f7aa66">icalmemory_tmp_copy</a>(str);</div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="aicalmemory_8h_html_aeae6b906a9fcba61eb725d060361b180"><div class="ttname"><a href="icalmemory_8h.html#aeae6b906a9fcba61eb725d060361b180">icalmemory_strdup</a></div><div class="ttdeci">char * icalmemory_strdup(const char *s)</div><div class="ttdoc">Creates a duplicate of a string.</div><div class="ttdef"><b>Definition:</b> icalmemory.c:251</div></div>
<div class="ttc" id="aicalmemory_8h_html_a2f164cb87c67f06b5dc04a5f21384879"><div class="ttname"><a href="icalmemory_8h.html#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a></div><div class="ttdeci">void icalmemory_free_buffer(void *buf)</div><div class="ttdoc">Releases a buffer.</div><div class="ttdef"><b>Definition:</b> icalmemory.c:287</div></div>
<div class="ttc" id="aicalmemory_8h_html_ad73fe2ed5791e8d4d4513b1e23f7b86e"><div class="ttname"><a href="icalmemory_8h.html#ad73fe2ed5791e8d4d4513b1e23f7b86e">icalmemory_tmp_buffer</a></div><div class="ttdeci">void * icalmemory_tmp_buffer(size_t size)</div><div class="ttdoc">Creates a new temporary buffer on the ring and returns it.</div><div class="ttdef"><b>Definition:</b> icalmemory.c:205</div></div>
<div class="ttc" id="aicalmemory_8h_html_a175daa67f089bae6aefd4360fcd0d664"><div class="ttname"><a href="icalmemory_8h.html#a175daa67f089bae6aefd4360fcd0d664">icalmemory_free_ring</a></div><div class="ttdeci">void icalmemory_free_ring(void)</div><div class="ttdoc">Frees all memory used in the ring.</div><div class="ttdef"><b>Definition:</b> icalmemory.c:227</div></div>
<div class="ttc" id="aicalmemory_8h_html_addac122edb16bc41a193895c86bd5ff5"><div class="ttname"><a href="icalmemory_8h.html#addac122edb16bc41a193895c86bd5ff5">icalmemory_append_char</a></div><div class="ttdeci">void icalmemory_append_char(char **buf, char **pos, size_t *buf_size, char ch)</div><div class="ttdoc">Appends a character to a buffer.</div><div class="ttdef"><b>Definition:</b> icalmemory.c:330</div></div>
<div class="ttc" id="aicalmemory_8h_html_ae9f1799733a1577748a028181098be48"><div class="ttname"><a href="icalmemory_8h.html#ae9f1799733a1577748a028181098be48">icalmemory_add_tmp_buffer</a></div><div class="ttdeci">void icalmemory_add_tmp_buffer(void *buf)</div><div class="ttdoc">Adds an externally allocated buffer to the ring.</div><div class="ttdef"><b>Definition:</b> icalmemory.c:182</div></div>
<div class="ttc" id="aicalmemory_8h_html_a44986d86c778125a313d423b70cd2b54"><div class="ttname"><a href="icalmemory_8h.html#a44986d86c778125a313d423b70cd2b54">icalmemory_new_buffer</a></div><div class="ttdeci">void * icalmemory_new_buffer(size_t size)</div><div class="ttdoc">Creates new buffer with the specified size.</div><div class="ttdef"><b>Definition:</b> icalmemory.c:261</div></div>
<div class="ttc" id="aicalmemory_8h_html_a4e657ee861bf1f00ed4e6eb03cd4a0a5"><div class="ttname"><a href="icalmemory_8h.html#a4e657ee861bf1f00ed4e6eb03cd4a0a5">icalmemory_resize_buffer</a></div><div class="ttdeci">void * icalmemory_resize_buffer(void *buf, size_t size)</div><div class="ttdoc">Resizes a buffer created with icalmemory_new_buffer().</div><div class="ttdef"><b>Definition:</b> icalmemory.c:275</div></div>
<div class="ttc" id="aicalmemory_8h_html_a3f5eccaa6b37d176a970b7d3a9f7aa66"><div class="ttname"><a href="icalmemory_8h.html#a3f5eccaa6b37d176a970b7d3a9f7aa66">icalmemory_tmp_copy</a></div><div class="ttdeci">char * icalmemory_tmp_copy(const char *str)</div><div class="ttdoc">Creates a copy of the given string, stored on the ring buffer, and returns it.</div><div class="ttdef"><b>Definition:</b> icalmemory.c:242</div></div>
<div class="ttc" id="aicalmemory_8h_html_a647bf5dab81fc5b83a0ed8f8ad769ea6"><div class="ttname"><a href="icalmemory_8h.html#a647bf5dab81fc5b83a0ed8f8ad769ea6">icalmemory_append_string</a></div><div class="ttdeci">void icalmemory_append_string(char **buf, char **pos, size_t *buf_size, const char *string)</div><div class="ttdoc">Appends a string to a buffer.</div><div class="ttdef"><b>Definition:</b> icalmemory.c:292</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Oct 9 2021 12:48:12 for Libical API Documentation by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
